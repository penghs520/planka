## 集群相关

### 1.如何进行集群初始化？
在README.md中介绍过，这里不再赘述。

### 2.如何进行集群的扩容？
集群扩容是指向现有集群添加新节点以提高系统容量和可用性的过程。建议集群节点数为奇数，以符合Raft选举要求。

**示例场景**：将3节点集群【1、2、3】扩容为5节点集群【1、2、3、4、5】

**操作步骤**：
1. **启动新节点**：按照README.md中的配置说明启动节点4和节点5
2. **添加学习者节点**：将新节点以学习者身份加入集群
   ```shell
   pgraph> add-learner 4 127.0.0.1:13897
   pgraph> add-learner 5 127.0.0.1:13898
   ```
3. **提升为正式成员**：将学习者节点提升为具有投票权的正式成员
   ```shell
   pgraph> change-membership 1,2,3,4,5
   ```

### 3.如何进行集群缩容？
集群缩容是指从现有集群中移除不需要的节点以优化资源使用的过程。

**示例场景**：将3节点集群【1、2、3】缩容为2节点集群，移除节点3

**操作步骤**：
```shell
pgraph> change-membership 1,2
```

### 4.某节点从集群移除后如何重新加入集群？
节点重新加入集群的过程与添加全新节点相同，需要经过学习者阶段。

**示例场景**：节点3从集群【1、2、3】中移除后重新加入

**操作步骤**：
1. **确保节点状态**：确认节点3已完全脱离原集群
2. **重新添加为学习者**：
   ```shell
   pgraph> add-learner 3 127.0.0.1:13896
   ```
3. **提升为正式成员**：
   ```shell
   pgraph> change-membership 1,2,3
   ```

## 5. change-membership命令会不会将Leader节点移除集群？

为了确保集群稳定性，pgraph在实现中增加了Leader保护机制：

### 保护机制说明
1. **自动检查**: 在执行`change-membership`命令前，系统会自动获取当前集群状态并检查Leader节点
2. **Leader保护**: 如果新的成员列表不包含当前Leader节点，系统会拒绝执行该操作

### 示例场景
假设当前集群有节点【1、2、3】，节点1是Leader：

**安全操作**（包含Leader）：
```shell
pgraph> change-membership 1,2,4  # ✅ 可以执行，包含Leader节点1
```

**危险操作**（不包含Leader）：
```shell
pgraph> change-membership 2,3,4  # ❌ 被拒绝，不包含Leader节点1
```
