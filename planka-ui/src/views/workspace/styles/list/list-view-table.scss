/**
 * 列表视图表格样式
 */

// 左侧滚动遮罩 - 防止内容穿透padding区域
.left-scroll-mask {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px; // 与左侧padding相同
  background: var(--color-bg-1); // 与面板背景色一致
  z-index: 30; // 确保在表头固定列之上
  pointer-events: none; // 不阻挡点击事件
}

// 表格容器 - 外层滚动容器
.table-container {
  flex: 1;
  padding: 0 4px 0;
  overflow: auto;
  display: flex;
  flex-direction: column;

  // 表格不需要内部滚动
  :deep(.arco-table) {
    flex: none;
  }

  // 覆盖 Arco Table 默认的 min-width: 100%，防止列数少时列宽被拉伸
  :deep(.arco-table .arco-table-element) {
    min-width: auto !important;
  }

  // 固定列宽度强制设置
  :deep(.arco-table-checkbox) {
    width: 40px !important;
    min-width: 40px !important;
    max-width: 40px !important;
  }

  // 加号列（第二列）
  :deep(.arco-table-th:nth-child(2)),
  :deep(.arco-table-td:nth-child(2)) {
    width: 36px !important;
    min-width: 36px !important;
    max-width: 36px !important;
  }



  // 移除固定列的阴影效果
  :deep(.arco-table-col-fixed-left-last::after),
  :deep(.arco-table-col-fixed-right-first::after),
  :deep(.arco-table-container::after) {
    box-shadow: none !important;
  }

  // 使用 Arco 原生的固定表头（通过 scroll.y），确保表头 z-index 正确
  :deep(thead) {
    z-index: 20;
    background: var(--color-bg-1);
  }

  // 表头固定列 z-index 更高，防止被数据行固定列覆盖
  :deep(thead .arco-table-col-fixed-left),
  :deep(thead .arco-table-col-fixed-right) {
    z-index: 21 !important;
  }

  // 表头样式
  :deep(.arco-table-th) {
    background: var(--color-fill-1) !important;
    height: 32px !important;
    line-height: 32px !important;
    font-weight: normal !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  // 表格行样式
  :deep(.arco-table-tr) {
    cursor: default;

    &:hover td {
      background-color: rgb(var(--primary-1)) !important;
    }

    // 选中行不显示灰色背景，hover 时显示
    &.arco-table-tr-checked:not(:hover) td {
      background-color: transparent !important;
    }

    // 选中行的固定列需要保持不透明背景，防止水平滚动时内容穿透
    &.arco-table-tr-checked:not(:hover) td.arco-table-col-fixed-left,
    &.arco-table-tr-checked:not(:hover) td.arco-table-col-fixed-right {
      background-color: var(--color-bg-1) !important;
    }
  }

  // 固定列 hover 背景色（需要单独设置以覆盖 Arco 默认样式）
  :deep(.arco-table-hover .arco-table-tr:hover .arco-table-col-fixed-left),
  :deep(.arco-table-hover .arco-table-tr:hover .arco-table-col-fixed-right) {
    background-color: rgb(var(--primary-1)) !important;

    // 清除 Arco 给固定列添加的 ::before 伪元素背景，避免 hover 时颜色不一致
    &::before {
      background-color: transparent !important;
    }
  }

  // 固定列常态背景色 - 防止水平滚动时内容穿透
  :deep(.arco-table-col-fixed-left),
  :deep(.arco-table-col-fixed-right) {
    background-color: var(--color-bg-1);
  }

  // 单元格通用样式
  :deep(.arco-table-td) {
    padding-left: 0 !important;
    padding-right: 0 !important;
    border-bottom-color: var(--color-fill-2) !important;
  }

  // 行高 - 标准
  &.row-height-standard :deep(.arco-table-td) {
    padding-top: 4px !important;
    padding-bottom: 4px !important;
  }

  // 行高 - 二倍
  &.row-height-double :deep(.arco-table-td) {
    padding-top: 14px !important;
    padding-bottom: 14px !important;
  }

  // 行高 - 三倍
  &.row-height-triple :deep(.arco-table-td) {
    padding-top: 20px !important;
    padding-bottom: 20px !important;
  }

  // 行高 - 四倍
  &.row-height-quadruple :deep(.arco-table-td) {
    padding-top: 26px !important;
    padding-bottom: 26px !important;
  }

  :deep(.arco-table-cell) {
    padding: 0 8px !important;
  }

  // 复选框列 - 固定宽度
  :deep(.arco-table-checkbox) {
    width: 40px !important;
    min-width: 40px !important;
    max-width: 40px !important;
    padding: 0 !important;

    .arco-table-cell {
      padding: 0 8px 0 12px !important;
    }
  }

  :deep(.arco-checkbox-icon) {
    border-width: 1px;
  }

  // 表体行复选框默认隐藏，hover 或选中时显示
  :deep(.arco-table-body .arco-checkbox) {
    opacity: 0;
    transition: opacity 0.2s;
  }

  :deep(.arco-table-body .arco-table-tr:hover .arco-checkbox),
  :deep(.arco-table-body .arco-checkbox.arco-checkbox-checked) {
    opacity: 1;
  }



  // 标题列移除左侧 padding
  :deep(.arco-table-th:nth-child(3) .arco-table-cell),
  :deep(.arco-table-td:nth-child(3) .arco-table-cell) {
    padding-left: 0 !important;
  }

  // 标题链接样式
  :deep(.arco-link) {
    padding-left: 0 !important;
    padding-right: 0 !important;

    &:hover {
      background-color: transparent !important;
    }
  }

  // 修复编辑图标被裁剪的问题
  :deep(.arco-table-td-content.arco-table-text-ellipsis) {
    overflow: visible !important;
  }
}

// 单元格显示容器（双击可编辑）
.cell-display {
  width: 100%;
  min-height: 22px;
  cursor: default;

  .cell-value,
  .cell-link {
    display: block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  // 覆盖 a-typography-text 默认样式
  :deep(.arco-typography) {
    margin-bottom: 0;
    font-size: inherit;
    line-height: inherit;
    font-weight: normal;
  }

  // 标题列特殊样式
  &.title-cell {
    display: flex;
    align-items: center;
    gap: 4px;

    .cell-link {
      flex: 1;
      min-width: 0;
      color: var(--color-text-1);
      cursor: pointer;

      &:hover {
        color: rgb(var(--primary-6));
      }
    }
  }
}

// 标题编辑图标
.title-edit-icon {
  flex-shrink: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border-radius: 4px;
  cursor: pointer;
  color: var(--color-text-4);
  opacity: 0;
  transition: opacity 0.2s, background-color 0.2s, color 0.2s;

  &:hover {
    background-color: rgb(var(--primary-1));
    color: rgb(var(--primary-6));
  }

  // 行 hover 时显示图标
  .arco-table-tr:hover & {
    opacity: 1;
  }
}

// 单元格文本溢出处理
.cell-value {
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

// 危险操作选项
:deep(.danger-option) {
  color: rgb(var(--danger-6));
}

// 加载更多指示器
.loading-more {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 12px 0;
  color: var(--color-text-3);
  font-size: 13px;
}